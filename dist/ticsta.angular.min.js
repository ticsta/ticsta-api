!function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b){b.exports=function(a,b,c){var d=a.endpoint("accounts",{credentials:c,authenticate:function(a){var c=this;return this.credentials.token?a?a(null,this.credentials.token):this.credentials.token:this.http._http(this.options.host+"/access_token","GET",{headers:{"x-api-key":this.credentials.key}},function(d,e,f){return a&&d||f.status?(d=d||f.error,a(d)):(c.credentials.token=f.access_token||f.token||c.credentials.token,b.setToken(c.credentials.token),void(a&&a(d,c.credentials.token)))})},setCredentials:function(a){this.credentials||(this.credentials={}),this.credentials.key=a.key,this.credentials.token=a.token},me:function(a){return this.http.request(this.url()+"/me","GET",a)},regenerateKey:function(a){return this.http.request(this.url()+"/me/key","PUT",a)}});return d}},{}],2:[function(a,b){b.exports={account:a("./account.js"),websites:a("./websites.js"),nodes:a("./nodes.js"),website:a("./website.js")}},{"./account.js":1,"./nodes.js":3,"./website.js":4,"./websites.js":5}],3:[function(a,b){b.exports=function(a){var b=a.endpoint("nodes",{active:function(a){return this.http.request(this.url()+"/active","GET",a)}});return b}},{}],4:[function(a,b){b.exports=function(a){var b=["documents","files","members","groups","doctypes","groupitems"],c="v0";return function(d){var e=d.version||c,f=a.endpoint(e,{});f.options.host=d.host;var g=f.one(d.id);return b.forEach(function(a){g[a]=g.endpoint(a,{count:function(a,b){return a&&"object"==typeof a&&(b=a,a=void 0),this.http.request(this.url()+"/count","GET",b,a)}})}),g.publisher=g.endpoint("publisher",{_pub:function(a,b,c,d){return c&&"object"==typeof c&&(d=c,c=void 0),this.http.request(a,b,d,c)},reset:function(a,b){return this.create(null,a,b)},publishDocument:function(a,b,c){return this._pub(this.url()+"/documents/"+a,"PUT",b,c)},unpublishDocument:function(a,b,c){return this._pub(this.url()+"/documents/"+a,"DELETE",b,c)}}),g}}},{}],5:[function(a,b){b.exports=function(a){var b=a.endpoint("websites",{my:function(a){return this.http.request(this.url()+"/my","GET",a)},id:function(a){var b=this.one(a);return b.node=function(a){return this.http.request(this.url()+"/node","GET",a)},b.domains=b.endpoint("domains",{id:function(a){var b=this.one(a);return b.templates=b.endpoint("templates",{}),b}}),b.members=b.endpoint("members",{me:function(a){return this.http.request(this.url()+"/me","GET",a)},invite:function(a,b){return this.http.request(this.url()+"/invite","POST",{form:a},b)}}),b}});return b}},{}],6:[function(a,b){var c=a("active-memory")({ttl:6e4}),d={};b.exports=function(a){var b=a.prototype._request;a.prototype._request=function(a,e){var f=d.getCacheInfo(a);if(!f)return b.call(this,a,e);if("GET"===f.method){var g=c.get(f.type,f.key);if(g)return g={data:g},e(null,g,g)}b.call(this,a,function(b,d,g){if(b)return e(b);if("GET"===f.method&&a.cache!==!1)c.set(f.type,f.key,d.data);else if("PUT"===f.method){var h=a.data||a.form;h.id=h.id||f.id,c.update(f.type,f.key,h)}else"POST"===f.method?c.add(f.type,d.data):"DELETE"===f.method&&c.remove(f.type,{id:f.id});e(null,d,g)})}},d.getCacheInfo=function(a){var b={key:a.url,method:a.method.toUpperCase()},c=JSON.stringify(a.params||a.qs||"");b.key+=c.length>1?c:"",b.key=b.key.toLowerCase();for(var d=0;d<e.finders.length;d++){var f=e.finders[d],g=f.exec(a.url);if(g){b.type=g[1],g.length>2&&(b.id=g[2]);break}}return b.type?b:null};var e={finders:[/\/v\d\/(websites)\/my$/,/\/v\d\/(websites)\/(\d+)$/,/\/v\d\/(websites)$/,/\/v\d\/(nodes)\/active$/,/\/v\d\/websites\/(?:\d+)\/(domains)$/,/\/v\d\/websites\/(?:\d+)\/(members)$/,/\/v\d\/websites\/(?:\d+)\/(members)\/([\w\d]+)$/,/\/v\d\/(?:\d+)\/(doctypes)$/,/\/v\d\/(?:\d+)\/(doctypes)\/([\w\d]+)$/,/\/v\d\/(?:\d+)\/(documents)$/,/\/v\d\/(?:\d+)\/(documents)\/([\w\d-]+)$/,/\/v\d\/(?:\d+)\/(groups)$/,/\/v\d\/(?:\d+)\/(groups)\/([\w\d]+)$/]}},{"active-memory":10}],7:[function(a){angular.module("ticsta",[]).provider("ticsta",function(){var b=a("../ticsta"),c=a("narrator2").Http,d=a("narrator2/lib/browser/asQ"),e=a("narrator2/lib/browser/asHttp"),f=a("./cache");return{_options:{},configure:function(a){this._options=a},$get:["$rootScope","$q","$http",function(a,g,h){return a.narratorApply=function(a){var b=this.$root.$$phase;"$apply"===b||"$digest"===b?a&&"function"==typeof a&&a():this.$apply(a)},d(c,a,g),e(c,h),f(c),b.createClient(this._options)}]}})},{"../ticsta":9,"./cache":6,narrator2:22,"narrator2/lib/browser/asHttp":16,"narrator2/lib/browser/asQ":17}],8:[function(a,b){b.exports=function(a,b){return a=a||{},Object.keys(b).forEach(function(c){"undefined"==typeof a[c]&&(a[c]=b[c])}),a}},{}],9:[function(a,b){(function(c){var d=a("narrator2"),e=a("tiny-emitter"),f=(a("amp-extend"),a("re-emitter")),g=a("./helpers/defaults"),h=a("./api"),i="v0",j=function(a){this.defaults={},this.options=g(a,this.defaults),this.events=new e;var b={host:c.env.TICSTA_API_URL||a.host||"https://api.ticsta.com",headers:{}},j=c.env.TICSTA_API_VERSION||a.version||i;b.host+="/"+j,this._api=new d(b),a.token&&this.setToken(a.token),this.account=h.account(this._api,this,a),this.websites=h.websites(this._api,this),this.nodes=h.nodes(this._api,this),this.website=h.website(this._api,this),f(this._api,this.events,["response","response:success","response:error"])};j.createClient=function(a){return new j(a)},j.prototype.setToken=function(a){this.options.token=a,this._api.headers.authentication="token "+a},j.prototype.setKey=function(a){this.options.key=a},b.exports=j}).call(this,a("_process"))},{"./api":2,"./helpers/defaults":8,_process:15,"amp-extend":11,narrator2:22,"re-emitter":25,"tiny-emitter":26}],10:[function(a,b,c){!function(a){function d(a){a=e.defaults(a,{ttl:0,idName:"id"});var b={},c={getIdName:function(){return a.idName},createCacheItem:function(b,c){var d=c&&e.isNumber(c.ttl)?c.ttl:a.ttl;return d>0&&(d=Date.now()+d),{format:e.isArray(b)?"l":"i",value:b,expires:d}},container:function(a){return b[a]||(b[a]={all:{},item:{},list:{}})},pick:function(a,b){var d=c.container(a);return d.all[b]},get:function(a,b){var d=c.pick(a,b);if(d)return c.isExpired(d)?void c.clearKey(a,b):d.value},set:function(a,b,d,e){var f=c.pick(a,b);if(f)return c.update(a,b,d,e);f=c.createCacheItem(d,e);var g=c.container(a);g.all[b]=f,"i"===f.format?g.item[b]=f:g.list[b]=f},update:function(a,b,d,e){var f=c.container(a),g=f.all[b];if(!g)return g=c.createCacheItem(d,e),void("i"===g.format&&c.updateListsItem(a,g,e));if("i"===g.format){for(var h in d)g.value[h]=d[h];c.updateListsItem(a,g,e)}else g.value.splice(0,g.value.length),d.forEach(function(a){g.value.push(a)})},updateListsItem:function(a,b){for(var d=c.container(a),e=c.getListsItemInfo(d,a,b),f=e.length-1;f>=0;f--){var g=e[f];for(var h in b.value)g.item[h]=b.value[h]}},isExpired:function(a){return a.expires>0&&Date.now()>a.expires},remove:function(a,b){var d,f=c.container(a);return e.isString(b)?(d=f.all[b],c.removeItem(f,a,b,d)):(d=c.createCacheItem(b),c.removeItem(f,a,null,d))},clear:function(){b={}},clearKey:function(a,b){var d=c.container(a);delete d.all[b],delete d.item[b],delete d.list[b]},removeItem:function(a,b,d,e){if(d&&c.clearKey(b,d),e&&"i"===e.format)for(var f=c.getListsItemInfo(a,b,e),g=f.length-1;g>=0;g--){var h=f[g];h.list.splice(h.index,1)}},add:function(a,b,d){var e=c.createCacheItem(b,d);if("i"===e.format){var f=c.container(a).list;for(var g in f){var h=f[g];h.value.push(e.value)}}},getListsItemInfo:function(a,b,d){var e=c.getIdName(b),f=[];for(var g in a.list)for(var h=a.list[g].value,i=h.length-1;i>=0;i--){var j=h[i];if(j[e].toString()===d.value[e].toString()){f.push({list:h,item:j,index:i});break}}return f}},d={get:function(a,b){return c.get(a,b)},set:function(a,b,d,e){return c.set(a,b,d,e)},remove:function(a,b,d){return c.remove(a,b,d)},update:function(a,b,d){return c.update(a,b,d)},add:function(a,b,d){return c.add(a,b,d)},clear:c.clear};return d}"function"==typeof define&&define.amd?define([""],function(){return a.activeMemory=d}):"object"==typeof c?b.exports=d:a.activeMemory=d;var e={defaults:function(a,b){return a=a||{},Object.keys(b).forEach(function(c){"undefined"==typeof a[c]&&(a[c]=b[c])}),a},isArray:function(a){return Array.isArray(a)},isNumber:function(a){return"number"==typeof a},isString:function(a){return"string"==typeof a}}}(this)},{}],11:[function(a,b){var c=a("amp-is-object");b.exports=function(a){if(!c(a))return a;for(var b,d,e=1,f=arguments.length;f>e;e++){b=arguments[e];for(d in b)a[d]=b[d]}return a}},{"amp-is-object":12}],12:[function(a,b){b.exports=function(a){var b=typeof a;return!!a&&("function"===b||"object"===b)}},{}],13:[function(){},{}],14:[function(a,b){function c(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function d(a){return"function"==typeof a}function e(a){return"number"==typeof a}function f(a){return"object"==typeof a&&null!==a}function g(a){return void 0===a}b.exports=c,c.EventEmitter=c,c.prototype._events=void 0,c.prototype._maxListeners=void 0,c.defaultMaxListeners=10,c.prototype.setMaxListeners=function(a){if(!e(a)||0>a||isNaN(a))throw TypeError("n must be a positive number");return this._maxListeners=a,this},c.prototype.emit=function(a){var b,c,e,h,i,j;if(this._events||(this._events={}),"error"===a&&(!this._events.error||f(this._events.error)&&!this._events.error.length)){if(b=arguments[1],b instanceof Error)throw b;throw TypeError('Uncaught, unspecified "error" event.')}if(c=this._events[a],g(c))return!1;if(d(c))switch(arguments.length){case 1:c.call(this);break;case 2:c.call(this,arguments[1]);break;case 3:c.call(this,arguments[1],arguments[2]);break;default:for(e=arguments.length,h=new Array(e-1),i=1;e>i;i++)h[i-1]=arguments[i];c.apply(this,h)}else if(f(c)){for(e=arguments.length,h=new Array(e-1),i=1;e>i;i++)h[i-1]=arguments[i];for(j=c.slice(),e=j.length,i=0;e>i;i++)j[i].apply(this,h)}return!0},c.prototype.addListener=function(a,b){var e;if(!d(b))throw TypeError("listener must be a function");if(this._events||(this._events={}),this._events.newListener&&this.emit("newListener",a,d(b.listener)?b.listener:b),this._events[a]?f(this._events[a])?this._events[a].push(b):this._events[a]=[this._events[a],b]:this._events[a]=b,f(this._events[a])&&!this._events[a].warned){var e;e=g(this._maxListeners)?c.defaultMaxListeners:this._maxListeners,e&&e>0&&this._events[a].length>e&&(this._events[a].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[a].length),"function"==typeof console.trace&&console.trace())}return this},c.prototype.on=c.prototype.addListener,c.prototype.once=function(a,b){function c(){this.removeListener(a,c),e||(e=!0,b.apply(this,arguments))}if(!d(b))throw TypeError("listener must be a function");var e=!1;return c.listener=b,this.on(a,c),this},c.prototype.removeListener=function(a,b){var c,e,g,h;if(!d(b))throw TypeError("listener must be a function");if(!this._events||!this._events[a])return this;if(c=this._events[a],g=c.length,e=-1,c===b||d(c.listener)&&c.listener===b)delete this._events[a],this._events.removeListener&&this.emit("removeListener",a,b);else if(f(c)){for(h=g;h-->0;)if(c[h]===b||c[h].listener&&c[h].listener===b){e=h;break}if(0>e)return this;1===c.length?(c.length=0,delete this._events[a]):c.splice(e,1),this._events.removeListener&&this.emit("removeListener",a,b)}return this},c.prototype.removeAllListeners=function(a){var b,c;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[a]&&delete this._events[a],this;if(0===arguments.length){for(b in this._events)"removeListener"!==b&&this.removeAllListeners(b);return this.removeAllListeners("removeListener"),this._events={},this}if(c=this._events[a],d(c))this.removeListener(a,c);else for(;c.length;)this.removeListener(a,c[c.length-1]);return delete this._events[a],this},c.prototype.listeners=function(a){var b;return b=this._events&&this._events[a]?d(this._events[a])?[this._events[a]]:this._events[a].slice():[]},c.listenerCount=function(a,b){var c;return c=a._events&&a._events[b]?d(a._events[b])?1:a._events[b].length:0}},{}],15:[function(a,b){function c(){if(!g){g=!0;for(var a,b=f.length;b;){a=f,f=[];for(var c=-1;++c<b;)a[c]();b=f.length}g=!1}}function d(){}var e=b.exports={},f=[],g=!1;e.nextTick=function(a){f.push(a),g||setTimeout(c,0)},e.title="browser",e.browser=!0,e.env={},e.argv=[],e.version="",e.versions={},e.on=d,e.addListener=d,e.once=d,e.off=d,e.removeListener=d,e.removeAllListeners=d,e.emit=d,e.binding=function(){throw new Error("process.binding is not supported")},e.cwd=function(){return"/"},e.chdir=function(){throw new Error("process.chdir is not supported")},e.umask=function(){return 0}},{}],16:[function(a,b){b.exports=function(a,b){a.prototype._request=function(a,c){a.data=a.data||a.form,angular.extend(a,this.options.context.options.api._xhr),a.qs&&!a.params&&(a.params=a.qs),b(a).success(function(a){var b=a.self||a;c(null,b,b)}).error(function(a){c(a)})}}},{}],17:[function(a,b){b.exports=function(a,b,c){a.prototype._promiseWrap=function(a){var d=c.defer();return a(function(a){b.narratorApply(function(){d.resolve(a)})},function(a){b.narratorApply(function(){d.reject(a)})}),d.promise}}},{}],18:[function(a,b){var c=a("./helpers/defaults"),d=a("extend"),e=a("url-join"),f=a("./http"),g=b.exports=function(a){this.hooks={pre:function(a){a()}},this.options={host:"",path:"",headers:{},_endpoints:{}},a||(a={}),a.userDefined||(a.userDefined={}),c(a.userDefined.hooks,this.hooks),d(this.options,a),d(this,a.userDefined),this.http=new f({context:this,headers:this.options.headers,hooks:this.hooks})},h=a("./entity");g.prototype.url=function(){return e(this.options.host,this.options.path)},g.prototype.one=function(a,b){var c=new h({_endpoints:this.options._endpoints,host:this.options.host,path:e("/",this.options.path),headers:this.options.headers,userDefined:b||{},id:a,api:this.options.api});return c},g.prototype.list=function(a,b){return a&&"object"==typeof a&&(b=a,a=null),this.http.request(this.url(),"GET",b,function(b,c,d){a&&a(b,d)})},g.prototype.create=function(a,b,c){return b&&"object"==typeof b&&(c=b,b=null),c=c||{},c.form=a,this.http.request(this.url(),"POST",c,function(a,c,d){b&&b(a,d)})},g.prototype.getEndpoint=function(a,b){var c=b?a+b:a;return this.options._endpoints[c]}},{"./entity":19,"./helpers/defaults":20,"./http":21,extend:23,"url-join":24}],19:[function(a,b){var c=a("./http"),d=a("url-join"),e=a("./helpers/defaults"),f=a("extend"),g=b.exports=function(a){this.hooks={pre:function(a){a()}},this.options={host:"",path:"",headers:{},id:0,_endpoints:{}},a||(a={}),a.userDefined||(a.userDefined={}),e(a.userDefined.hooks,this.hooks),f(this.options,a),f(this,a.userDefined),this.http=new c({context:this,headers:this.options.headers,hooks:this.hooks})},h=a("./narrator");g.prototype.endpoint=function(a,b){var c=new h({id:this.options.id,host:this.url(),headers:this.options.headers,_endpoints:this.options._endpoints});return c.endpoint(a,b)},g.prototype.url=function(){return d(this.options.host,this.options.path,this.options.id)},g.prototype.get=function(a,b){return a&&"object"==typeof a&&(b=a,a=null),this.http.request(this.url(),"GET",b,function(b,c,d){a&&a(b,d)})},g.prototype.update=function(a,b,c){return b&&"object"==typeof b&&(c=b,b=null),c=c||{},c.form=a,this.http.request(this.url(),"PUT",c,function(a,c,d){b&&b(a,d)})},g.prototype.remove=function(a,b){return a&&"object"==typeof a&&(b=a,a=null),this.http.request(this.url(),"DELETE",b,function(b,c,d){a&&a(b,d)})},g.prototype.getEndpoint=function(a,b){var c=b?a+b:a;return this.options._endpoints[c]}},{"./helpers/defaults":20,"./http":21,"./narrator":22,extend:23,"url-join":24}],20:[function(a,b,c){arguments[4][8][0].apply(c,arguments)},{dup:8}],21:[function(a,b){(function(c){var d=a("extend"),e=a("./helpers/defaults"),f=a("request"),g=a("promise"),h=b.exports=function(a){function b(a){return a.options.context.options&&a.options.context.options.api&&a.options.context.options.api.promise}this.options={headers:{},hooks:{},context:{}},d(this.options,a),this.promise=b(this)?this.options.context.options.api.promise:function(a){return new g(a)}};h.prototype.setHeaders=function(a){this.options.headers=a},h.prototype.setHeader=function(a,b){this.options.headers[a]=b},h.prototype.removeHeader=function(a){delete this.options.headers[a]},h.prototype._parseJSON=function(a){try{a=JSON.parse(a)}catch(b){}finally{return a}},h.prototype._promiseWrap=function(a){return new g(a)},h.prototype._request=f,h.prototype._http=function(a,b,c,d){var f=this;"function"==typeof c&&(d=c,c={}),"function"!=typeof d&&(d=function(){});var g={url:a,method:b};return g=e(c,g),this._promiseWrap(function(a,b){f._request(g,function(c,e,g){var h,i=f._parseJSON(g);f.options.context&&f.options.context.options.api&&(h=f.options.context.options.api),h&&h.emit("response",{error:c,response:e}),c||e.statusCode>=400?(h.emit("response:error",c||e),b(c)):(h.emit("response:success",e),a(i)),d(c,e,i)})})},h.prototype.request=function(a,b,e,f){var g=this;"function"==typeof e&&(f=e,e={});var h={},i={};return d(h,{headers:this.options.headers},e),d(i,h,{path:a,method:b}),this._promiseWrap(function(d,e){c.nextTick(function(){var c=g.options.hooks&&g.options.hooks.pre?g.options.hooks.pre:function(a){a()};c.call(g.options.context,function(){g._http(a,b,h,f).then(d,e)})})})}}).call(this,a("_process"))},{"./helpers/defaults":20,_process:15,extend:23,promise:13,request:13}],22:[function(a,b){var c=a("extend"),d=a("url-join"),e=(a("promise"),a("tiny-emitter")),f=b.exports=function(a){a=a||{},this._endpoints={},this.host="/",c(this,new e,a);var b=this.endpoint("").http;this._request=b._http,this.createPromise=b._promiseWrap};f.Http=a("./http");var g=a("./endpoint");f.prototype.endpoint=function(a,b){var c=this.id?a+this.id:a;if(!(c in this._endpoints)){var e=new g({host:this.host,path:d("/",a),headers:this.headers,userDefined:b||{},_endpoints:this._endpoints,api:this});this._endpoints[c]=e}return this._endpoints[c]},f.prototype._xhr={},f.prototype.withCredentials=function(a){return this.xhr("withCredentials",a),this},f.prototype.xhr=function(a,b){return this._xhr[a]=b,this}},{"./endpoint":18,"./http":21,extend:23,promise:13,"tiny-emitter":26,"url-join":24}],23:[function(a,b){var c,d=Object.prototype.hasOwnProperty,e=Object.prototype.toString,f=function(a){"use strict";if(!a||"[object Object]"!==e.call(a))return!1;var b=d.call(a,"constructor"),f=a.constructor&&a.constructor.prototype&&d.call(a.constructor.prototype,"isPrototypeOf");if(a.constructor&&!b&&!f)return!1;var g;for(g in a);return g===c||d.call(a,g)};b.exports=function g(){"use strict";var a,b,d,e,h,i,j=arguments[0],k=1,l=arguments.length,m=!1;for("boolean"==typeof j?(m=j,j=arguments[1]||{},k=2):("object"!=typeof j&&"function"!=typeof j||null==j)&&(j={});l>k;++k)if(a=arguments[k],null!=a)for(b in a)d=j[b],e=a[b],j!==e&&(m&&e&&(f(e)||(h=Array.isArray(e)))?(h?(h=!1,i=d&&Array.isArray(d)?d:[]):i=d&&f(d)?d:{},j[b]=g(m,i,e)):e!==c&&(j[b]=e));return j}},{}],24:[function(a,b){function c(a){return a.replace(/[\/]+/g,"/").replace(/\/\?/g,"?").replace(/\/\#/g,"#").replace(/\:\//g,"://")}b.exports=function(){var a=[].slice.call(arguments,0).join("/");return c(a)}},{}],25:[function(a,b){function c(a,b,c){Array.isArray(c)||(c=[c]),c.forEach(function(c){a.on(c,function(){var a=[].slice.call(arguments);a.unshift(c),b.emit.apply(b,a)})})}function d(a,b){var d=new e;return c(a,d,b),d}b.exports=c,b.exports.filter=d;var e=a("events").EventEmitter},{events:14}],26:[function(a,b){function c(){}c.prototype={on:function(a,b,c){var d=this.e||(this.e={});return(d[a]||(d[a]=[])).push({fn:b,ctx:c}),this},once:function(a,b,c){var d=this,e=function(){d.off(a,e),b.apply(c,arguments)};return this.on(a,e,c)},emit:function(a){var b=[].slice.call(arguments,1),c=((this.e||(this.e={}))[a]||[]).slice(),d=0,e=c.length;for(d;e>d;d++)c[d].fn.apply(c[d].ctx,b);return this},off:function(a,b){var c=this.e||(this.e={}),d=c[a],e=[];if(d&&b)for(var f=0,g=d.length;g>f;f++)d[f].fn!==b&&e.push(d[f]);return e.length?c[a]=e:delete c[a],this}},b.exports=c},{}]},{},[7]);